
{
  "/contracts/{id}/generate-signature": {
    "post": {
      "tags": ["Contracts"],
      "summary": "Generate and send an electronic signature link by email",
      "description": "Creates a unique signing link for a contract and sends it to the associated customer via email.",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": { "type": "string", "format": "uuid" },
          "description": "The unique ID of the contract"
        }
      ],
      "responses": {
        "200": {
          "description": "Signature link successfully generated and email sent",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "data": {
                    "type": "object",
                    "properties": {
                      "id": { "type": "string", "format": "uuid" },
                      "contract_id": { "type": "string", "format": "uuid" },
                      "customer_id": { "type": "string", "format": "uuid" },
                      "token": { "type": "string" },
                      "expires_at": { "type": "string", "format": "date-time" }
                    }
                  },
                  "link": { "type": "string", "description": "Generated signing link" },
                  "emailSentTo": { "type": "string", "format": "email" }
                }
              }
            }
          }
        },
        "400": {
          "description": "Invalid request or missing customer information"
        },
        "404": {
          "description": "Contract not found"
        },
        "500": {
          "description": "Failed to generate or send signature link"
        }
      }
    }
  },
  "/contracts/full-view": {
    "get": {
      "tags": ["Contracts"],
      "summary": "Get all contracts with full details (customer, package, dresses, addons)",
      "parameters": [
        {
          "name": "customer_id",
          "in": "query",
          "required": false,
          "schema": { "type": "string", "format": "uuid" }
        }
      ],
      "responses": {
        "200": {
          "description": "List of contracts with full details",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "data": {
                    "type": "array",
                    "items": { "type": "object" }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "/contracts": {
    "get": {
      "tags": ["Contracts"],
      "summary": "Get all contracts",
      "responses": {
        "200": {
          "description": "List of contracts",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "data": {
                    "type": "array",
                    "items": { "$ref": "#/components/schemas/Contract" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "post": {
      "tags": ["Contracts"],
      "summary": "Create a new contract",
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "required": [
                "contract_number",
                "customer_id",
                "contract_type_id",
                "start_datetime",
                "end_datetime",
                "account_ht",
                "account_ttc",
                "account_paid_ht",
                "account_paid_ttc",
                "caution_ht",
                "caution_ttc",
                "caution_paid_ht",
                "caution_paid_ttc",
                "total_price_ht",
                "total_price_ttc",
                "deposit_payment_method",
                "status"
              ],
              "properties": {
                "contract_number": { "type": "string" },
                "customer_id": { "type": "string", "format": "uuid" },
                "contract_type_id": { "type": "string", "format": "uuid" },
                "package_id": { "type": ["string", "null"], "format": "uuid" },
                "start_datetime": { "type": "string", "format": "date-time" },
                "end_datetime": { "type": "string", "format": "date-time" },
                "account_ht": { "type": "number" },
                "account_ttc": { "type": "number" },
                "account_paid_ht": { "type": "number" },
                "account_paid_ttc": { "type": "number" },
                "caution_ht": { "type": "number" },
                "caution_ttc": { "type": "number" },
                "caution_paid_ht": { "type": "number" },
                "caution_paid_ttc": { "type": "number" },
                "total_price_ht": { "type": "number" },
                "total_price_ttc": { "type": "number" },
                "deposit_payment_method": { "type": "string" },
                "status": { "type": "string" },
                "addons": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "addon_id": { "type": "string", "format": "uuid" }
                    }
                  }
                },
                "dresses": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "dress_id": { "type": "string", "format": "uuid" }
                    },
                    "required": ["dress_id"]
                  }
                }
              }
            }
          }
        }
      },
      "responses": {
        "201": {
          "description": "Contract created",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/Contract" }
            }
          }
        }
      }
    }
  },
  "/contracts/{id}": {
    "get": {
      "tags": ["Contracts"],
      "summary": "Get a contract by ID",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": { "type": "string", "format": "uuid" }
        }
      ],
      "responses": {
        "200": {
          "description": "Contract found",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/Contract" }
            }
          }
        },
        "404": { "description": "Contract not found" }
      }
    },
    "put": {
      "tags": ["Contracts"],
      "summary": "Update a contract",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": { "type": "string", "format": "uuid" }
        }
      ],
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "contract_number": { "type": "string" },
                "customer_id": { "type": "string", "format": "uuid" },
                "contract_type_id": { "type": "string", "format": "uuid" },
                "package_id": { "type": ["string", "null"], "format": "uuid" },
                "start_datetime": { "type": "string", "format": "date-time" },
                "end_datetime": { "type": "string", "format": "date-time" },
                "account_ht": { "type": "number" },
                "account_ttc": { "type": "number" },
                "account_paid_ht": { "type": "number" },
                "account_paid_ttc": { "type": "number" },
                "caution_ht": { "type": "number" },
                "caution_ttc": { "type": "number" },
                "caution_paid_ht": { "type": "number" },
                "caution_paid_ttc": { "type": "number" },
                "total_price_ht": { "type": "number" },
                "total_price_ttc": { "type": "number" },
                "deposit_payment_method": { "type": "string" },
                "status": { "type": "string" },
                "addons": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "addon_id": { "type": "string", "format": "uuid" }
                    }
                  }
                },
                "dresses": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "dress_id": { "type": "string", "format": "uuid" }
                    },
                    "required": ["dress_id"]
                  }
                }
              }
            }
          }
        }
      },
      "responses": {
        "200": {
          "description": "Contract updated",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/Contract" }
            }
          }
        }
      }
    },
    "patch": {
      "tags": ["Contracts"],
      "summary": "Soft delete a contract",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": { "type": "string", "format": "uuid" }
        }
      ],
      "responses": {
        "200": {
          "description": "Contract soft deleted",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/Contract" }
            }
          }
        }
      }
    }
  },
  "/contracts/{id}/hard": {
    "delete": {
      "tags": ["Contracts"],
      "summary": "Hard delete a contract",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": { "type": "string", "format": "uuid" }
        }
      ],
      "responses": {
        "200": {
          "description": "Contract permanently deleted",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "message": { "type": "string" }
                }
              }
            }
          }
        }
      }
    }
  }
}