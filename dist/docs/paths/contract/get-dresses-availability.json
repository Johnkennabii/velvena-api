{
  "/contracts/availability": {
    "get": {
      "tags": ["Contracts"],
      "summary": "Get dress availability in a given date range",
      "description": "Retourne **toutes** les robes actives (non supprim√©es), avec pour chacune un flag `isAvailable` indiquant si elle est libre dans l'intervalle demand√©. Une robe est consid√©r√©e comme *non disponible* si elle est li√©e √† un contrat (statut DRAFT, PENDING ou SIGNED) qui chevauche la p√©riode demand√©e.\n\nSi aucun intervalle n'est fourni, l'API consid√®re `start = maintenant` et retourne les robes qui sont d√©j√† lou√©es maintenant ou √† venir.",
      "operationId": "getDressesAvailability",
      "security": [
        { "bearerAuth": [] }
      ],
      "parameters": [
        {
          "name": "start",
          "in": "query",
          "required": false,
          "description": "D√©but de la p√©riode recherch√©e (ISO 8601). Exemple : 2025-10-21T10:00:00.000Z. Si non fourni, on utilise la date/heure actuelle.",
          "schema": {
            "type": "string",
            "format": "date-time",
            "example": "2025-10-21T10:00:00.000Z"
          }
        },
        {
          "name": "end",
          "in": "query",
          "required": false,
          "description": "Fin de la p√©riode recherch√©e (ISO 8601). Exemple : 2025-10-22T10:00:00.000Z. Si non fourni, on r√©cup√®re juste les contrats encore actifs apr√®s `start`.",
          "schema": {
            "type": "string",
            "format": "date-time",
            "example": "2025-10-22T10:00:00.000Z"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "‚úÖ Disponibilit√© calcul√©e",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DressAvailabilityResponse"
              },
              "examples": {
                "success": {
                  "summary": "Exemple de r√©ponse avec p√©riode fournie",
                  "value": {
                    "success": true,
                    "count": 2,
                    "filters": {
                      "start": "2025-10-21T10:00:00.000Z",
                      "end": "2025-10-22T10:00:00.000Z"
                    },
                    "data": [
                      {
                        "id": "5815dc9e-f860-4791-9ea5-deadb782329e",
                        "name": "Robe Orientale Dor√©e",
                        "reference": "REF-OR-202",
                        "price_ht": 1018.33,
                        "price_ttc": 1222,
                        "price_per_day_ht": 100,
                        "price_per_day_ttc": 120,
                        "images": [
                          "https://dresses.hel1.your-objectstorage.com/3df7a0e6-bbcd-43c8-8a3b-e0b1ab2fe6ac",
                          "https://dresses.hel1.your-objectstorage.com/7a2d2f4c-6f9d-4d36-8d9f-25b27a1c412e"
                        ],
                        "isAvailable": false,
                        "current_contract": {
                          "start_datetime": "2025-10-21T10:00:00.000Z",
                          "end_datetime": "2025-10-22T10:00:00.000Z"
                        }
                      },
                      {
                        "id": "864b2458-a632-433c-9bc3-2ba812bbd13a",
                        "name": "Robe Blanche Perl√©e",
                        "reference": "RB-PEARL-01",
                        "price_ht": 1000,
                        "price_ttc": 1200,
                        "price_per_day_ht": 166.67,
                        "price_per_day_ttc": 200,
                        "images": [
                          "https://dresses.hel1.your-objectstorage.com/b906924e-22b3-454f-8707-6b5cdfae8c5d"
                        ],
                        "isAvailable": true,
                        "current_contract": null
                      }
                    ]
                  }
                }
              }
            }
          }
        },
        "400": {
          "description": "‚ö†Ô∏è Erreur de validation (dates invalides)",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ErrorResponse"
              },
              "examples": {
                "invalidDates": {
                  "summary": "Dates invalides",
                  "value": {
                    "success": false,
                    "error": "Invalid start or end date"
                  }
                }
              }
            }
          }
        },
        "500": {
          "description": "üí• Erreur serveur lors du calcul des disponibilit√©s",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ErrorResponse"
              },
              "examples": {
                "serverError": {
                  "summary": "Erreur interne",
                  "value": {
                    "success": false,
                    "error": "Failed to fetch dress availability"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}