{
  "/prospects/{prospectId}/requests": {
    "post": {
      "tags": ["Prospect Requests"],
      "summary": "Create a new request for a prospect",
      "description": "Creates a new request (demande) for a prospect with one or more dresses. Automatically calculates rental days, estimated prices per dress, and total estimated prices.",
      "operationId": "createProspectRequest",
      "security": [{ "bearerAuth": [] }],
      "parameters": [
        {
          "name": "prospectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          },
          "description": "The prospect ID"
        }
      ],
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/CreateProspectRequestRequest" },
            "example": {
              "dresses": [
                {
                  "dress_id": "7d2f6f3a-18c5-43aa-812e-8df1b0b61f6f",
                  "rental_start_date": "2025-12-10",
                  "rental_end_date": "2025-12-15",
                  "notes": "Pour mariage"
                },
                {
                  "dress_id": "0b00222f-851e-4a7a-9e52-439b820e62ae",
                  "rental_start_date": "2025-12-10",
                  "rental_end_date": "2025-12-15"
                }
              ],
              "notes": "Client VIP",
              "status": "draft"
            }
          }
        }
      },
      "responses": {
        "201": {
          "description": "‚úÖ Request successfully created with calculations",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/CreateProspectRequestResponse" },
              "example": {
                "success": true,
                "data": {
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "request_number": "REQ-20251205-0001",
                  "prospect_id": "abc123-def456",
                  "status": "draft",
                  "total_estimated_ht": 500.00,
                  "total_estimated_ttc": 600.00,
                  "notes": "Client VIP",
                  "created_at": "2025-12-05T10:00:00.000Z",
                  "dresses": [
                    {
                      "id": "req-dress-001",
                      "dress_id": "7d2f6f3a-18c5-43aa-812e-8df1b0b61f6f",
                      "rental_start_date": "2025-12-10T00:00:00.000Z",
                      "rental_end_date": "2025-12-15T00:00:00.000Z",
                      "rental_days": 6,
                      "estimated_price_ht": 250.00,
                      "estimated_price_ttc": 300.00,
                      "notes": "Pour mariage",
                      "dress": {
                        "id": "7d2f6f3a-18c5-43aa-812e-8df1b0b61f6f",
                        "name": "Robe de mari√©e √âl√©gance",
                        "reference": "REF-2025-001",
                        "price_per_day_ht": 41.67,
                        "price_per_day_ttc": 50.00,
                        "type": { "name": "Robe de mari√©e" },
                        "size": { "name": "M" },
                        "color": { "name": "Blanc" }
                      }
                    },
                    {
                      "id": "req-dress-002",
                      "dress_id": "0b00222f-851e-4a7a-9e52-439b820e62ae",
                      "rental_start_date": "2025-12-10T00:00:00.000Z",
                      "rental_end_date": "2025-12-15T00:00:00.000Z",
                      "rental_days": 6,
                      "estimated_price_ht": 250.00,
                      "estimated_price_ttc": 300.00,
                      "dress": {
                        "id": "0b00222f-851e-4a7a-9e52-439b820e62ae",
                        "name": "Robe de soir√©e Prestige",
                        "reference": "REF-2025-002",
                        "price_per_day_ht": 41.67,
                        "price_per_day_ttc": 50.00,
                        "type": { "name": "Robe de soir√©e" },
                        "size": { "name": "L" },
                        "color": { "name": "Noir" }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "400": {
          "description": "‚ùå Bad request - invalid data",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ErrorResponse" }
            }
          }
        },
        "404": {
          "description": "‚ùå Prospect not found",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ErrorResponse" }
            }
          }
        },
        "500": {
          "description": "üí• Server error",
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ErrorResponse" }
            }
          }
        }
      }
    }
  }
}
