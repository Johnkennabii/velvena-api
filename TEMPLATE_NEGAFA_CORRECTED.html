<!-- En-tête du contrat -->
<div class="mb-6 text-center">
  <h1 class="text-2xl font-semibold text-gray-900">Contrat de prestation forfaitaire "Négafa"</h1>
  <p class="text-sm text-gray-600 mt-2">Contrat n° {{contract_number}} — {{created_at}}</p>
</div>

<!-- Informations client -->
<div class="mb-6">
  <h2 class="text-base font-semibold text-gray-900 mb-3">Informations client</h2>
  <div class="grid gap-3 md:grid-cols-2">
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Nom complet</p>
      <p class="mt-1 text-sm text-gray-800">{{customer_firstname}} {{customer_lastname}}</p>
    </div>
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Email</p>
      <p class="mt-1 text-sm text-gray-800">{{customer_email}}</p>
    </div>
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Téléphone</p>
      <p class="mt-1 text-sm text-gray-800">{{customer_phone}}</p>
    </div>
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Adresse</p>
      <p class="mt-1 text-sm text-gray-800">{{customer_address}}, {{customer_postal_code}} {{customer_city}}</p>
    </div>
  </div>
</div>

<!-- Détails du contrat -->
<div class="mb-6">
  <h2 class="text-base font-semibold text-gray-900 mb-3">Détails du contrat</h2>
  <div class="grid gap-3 md:grid-cols-2">
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Type de contrat</p>
      <p class="mt-1 text-sm text-gray-800">{{contract_type_name}}</p>
    </div>
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Période de prestation</p>
      <p class="mt-1 text-sm text-gray-800">{{start_datetime}} — {{end_datetime}}</p>
    </div>
    {{#if deposit_payment_method}}
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Méthode de paiement caution</p>
      <p class="mt-1 text-sm text-gray-800">{{deposit_payment_method}}</p>
    </div>
    {{/if}}
  </div>
</div>

<!-- Forfait -->
{{#if package_name}}
<div class="mb-6">
  <h2 class="text-base font-semibold text-gray-900 mb-3">Forfait</h2>
  <div class="grid gap-3 md:grid-cols-2">
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Nom du forfait</p>
      <p class="mt-1 text-sm text-gray-800">{{package_name}}</p>
    </div>
    {{#if package_num_dresses}}
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Nombre de robes incluses</p>
      <p class="mt-1 text-sm text-gray-800">{{package_num_dresses}} robe(s)</p>
    </div>
    {{/if}}
    {{#if package_price_ht}}
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Prix HT</p>
      <p class="mt-1 text-sm text-gray-800">{{package_price_ht}} €</p>
    </div>
    {{/if}}
    {{#if package_price_ttc}}
    <div>
      <p class="text-xs font-semibold uppercase text-gray-500">Prix TTC</p>
      <p class="mt-1 text-sm text-gray-800">{{package_price_ttc}} €</p>
    </div>
    {{/if}}
  </div>
</div>
{{/if}}

<!-- Récapitulatif financier -->
<div class="mb-6">
  <h2 class="text-base font-semibold text-gray-900 mb-3">Récapitulatif financier</h2>
  <div class="space-y-4">
    <div>
      <h3 class="text-sm font-medium text-gray-700 mb-2">Montant total</h3>
      <div class="grid gap-2 md:grid-cols-2">
        <div class="rounded-lg bg-gray-50 p-3">
          <p class="text-xs font-semibold uppercase text-gray-500">Total HT</p>
          <p class="mt-1 text-lg font-semibold text-gray-900">{{total_price_ht}} €</p>
        </div>
        <div class="rounded-lg bg-blue-50 p-3">
          <p class="text-xs font-semibold uppercase text-gray-500">Total TTC</p>
          <p class="mt-1 text-lg font-semibold text-blue-700">{{total_price_ttc}} €</p>
        </div>
      </div>
    </div>

    <div>
      <h3 class="text-sm font-medium text-gray-700 mb-2">Acompte</h3>
      <div class="grid gap-2 md:grid-cols-2">
        <div class="rounded-lg bg-gray-50 p-3">
          <p class="text-xs font-semibold uppercase text-gray-500">Acompte TTC</p>
          <p class="mt-1 text-sm font-semibold text-gray-900">{{account_ttc}} €</p>
        </div>
        <div class="rounded-lg bg-green-50 p-3">
          <p class="text-xs font-semibold uppercase text-gray-500">Payé TTC</p>
          <p class="mt-1 text-sm font-semibold text-green-700">{{account_paid_ttc}} €</p>
        </div>
      </div>
    </div>

    <div>
      <h3 class="text-sm font-medium text-gray-700 mb-2">Caution</h3>
      <div class="grid gap-2 md:grid-cols-2">
        <div class="rounded-lg bg-gray-50 p-3">
          <p class="text-xs font-semibold uppercase text-gray-500">Caution TTC</p>
          <p class="mt-1 text-sm font-semibold text-gray-900">{{caution_ttc}} €</p>
        </div>
        <div class="rounded-lg bg-green-50 p-3">
          <p class="text-xs font-semibold uppercase text-gray-500">Payée TTC</p>
          <p class="mt-1 text-sm font-semibold text-green-700">{{caution_paid_ttc}} €</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Robes incluses -->
{{#if dresses}}
<div class="mb-6">
  <h2 class="text-base font-semibold text-gray-900 mb-3">Robes incluses ({{dresses.length}})</h2>
  <div class="space-y-3">
    {{#each dresses}}
    <div class="rounded-lg border border-gray-200 bg-gray-50 p-3">
      <p class="font-medium text-gray-900">{{this.name}} — Réf. {{this.reference}}</p>
      {{#if this.type_name}}<p class="text-xs text-gray-600">Type: {{this.type_name}}</p>{{/if}}
      {{#if this.size_name}}<p class="text-xs text-gray-600">Taille: {{this.size_name}}</p>{{/if}}
      {{#if this.color_name}}<p class="text-xs text-gray-600">Couleur: {{this.color_name}}</p>{{/if}}
    </div>
    {{/each}}
  </div>
</div>
{{/if}}

<!-- Options -->
{{#if addons}}
<div class="mb-6">
  <h2 class="text-base font-semibold text-gray-900 mb-3">Options</h2>
  <div class="space-y-2">
    {{#each addons}}
    <div class="flex items-center justify-between rounded-lg border border-gray-100 bg-gray-50 px-3 py-2">
      <div class="flex-1">
        <p class="font-medium text-gray-900">{{this.name}}</p>
        {{#if this.description}}<p class="text-xs text-gray-600">{{this.description}}</p>{{/if}}
      </div>
      <p class="text-xs text-gray-500">{{this.price_ttc}} € TTC</p>
    </div>
    {{/each}}
  </div>
</div>
{{/if}}

<!-- Clauses contractuelles -->
<div class="mt-8 space-y-4 text-sm">
  <h2 class="text-lg font-semibold text-gray-900">Conditions générales</h2>

  <p><strong>Entre les soussignés :</strong></p>
  <p>
    La société <strong>{{org.name}}</strong>, société par actions simplifiée (SAS) immatriculée sous le numéro
    <strong>{{org.siret}}</strong>, sise {{org.address}}, {{org.city}}, représentée par
    <strong>{{org.managerFullName}}</strong> en qualité de gérant(e), ci-après dénommée « le Prestataire ».
  </p>
  <p>
    Et le Client, <strong>{{customer_firstname}} {{customer_lastname}}</strong>, domicilié(e) au {{customer_address}}, {{customer_postal_code}} {{customer_city}},
    joignable au {{customer_phone}} et à l'adresse email {{customer_email}}, ci-après dénommé(e) « le Client ».
  </p>

  <h3 class="font-semibold mt-4">Article 1 – Objet du contrat</h3>
  <p>
    Le présent contrat encadre une prestation de préparation, habillage, accompagnement et location de tenues traditionnelles
    fournie pour un événement personnel (mariage, fiançailles, cérémonie).
  </p>

  <h3 class="font-semibold mt-4">Article 2 – Description de la prestation</h3>
  <ul class="list-disc space-y-1 pl-6">
    <li>Essayage et sélection des tenues au showroom {{org.name}}.</li>
    <li>Location des tenues traditionnelles, accessoires et parures.</li>
    <li>Habillage et préparation de la Mariée sur place le jour J.</li>
    <li>Accompagnement, changements de tenues et présence continue dans la limite définie au présent contrat.</li>
  </ul>

  <h3 class="font-semibold mt-4">Article 3 – Durée de la prestation</h3>
  <p>
    La prestation est limitée à <strong>sept (7) heures consécutives</strong> (ex. 19h00 – 02h00).
    Toute heure supplémentaire entamée est facturée <strong>150 € TTC</strong>.
  </p>

  <h3 class="font-semibold mt-4">Article 4 – Mise à disposition d'un espace sécurisé</h3>
  <p>Le Client s'engage à fournir un espace dédié conforme aux exigences suivantes :</p>
  <ul class="list-disc space-y-1 pl-6">
    <li>Une loge ou un local sécurisé, fermé par clé ou code, destiné au matériel et à la préparation.</li>
    <li>Aucun objet personnel ou de valeur n'y est entreposé par le Client ou ses invités.</li>
    <li>{{org.name}} décline toute responsabilité en cas de perte, vol ou détérioration de biens tiers.</li>
    <li>Seule la négafa détient la clé ou le dispositif d'ouverture pendant la prestation.</li>
    <li>La loge est strictement réservée à la Mariée et au Prestataire.</li>
    <li>Le repas de la négafa (et de son assistante le cas échéant) est à la charge du Client.</li>
  </ul>

  <h3 class="font-semibold mt-4">Article 5 – Conditions financières</h3>
  <p>
    Les tarifs appliqués correspondent au forfait sélectionné par le Client.
    Un acompte de <strong>50 %</strong> est exigé à la signature du contrat.
    Le solde est dû à la remise des tenues.
  </p>
  <p>
    Tout retard ou défaut de paiement peut entraîner la suspension ou l'annulation de la prestation, sans indemnité pour le Client.
  </p>

  <h3 class="font-semibold mt-4">Article 6 – Caution</h3>
  <p>
    Une caution est obligatoire pour toute location. Elle est restituée après vérification de l'état du matériel.
    Toute perte, détérioration, tâche irréversible, brûlure, vol ou dommage entraîne une retenue partielle ou totale,
    sans préjudice d'une facturation complémentaire si nécessaire.
  </p>

  <h3 class="font-semibold mt-4">Article 7 – Substitution</h3>
  <p>
    En cas d'impossibilité indépendante de la volonté du Prestataire de fournir les biens initialement réservés,
    un bien de catégorie équivalente ou supérieure est proposé sans frais supplémentaires.
    Cette substitution n'est pas considérée comme un manquement contractuel.
  </p>

  <h3 class="font-semibold mt-4">Article 8 – Annulation</h3>
  <p>
    En cas d'annulation par le Client, l'acompte demeure acquis au Prestataire,
    sauf cas de force majeure dûment justifié. Toute demande d'annulation doit être formulée par écrit.
  </p>

  <h3 class="font-semibold mt-4">Article 9 – Engagement et signature</h3>
  <p>
    Le Client atteste avoir pris connaissance et accepté l'ensemble des conditions générales et particulières du présent contrat.
    L'acceptation électronique vaut signature manuscrite conformément à l'article 1367 du Code civil.
  </p>
</div>
