{
  "/sign-links/{token}/sign": {
    "post": {
      "summary": "Signer électroniquement un contrat via un lien de signature",
      "description": "Valide la signature électronique du contrat associé au token fourni. Si le lien est valide et non expiré, le statut du contrat est mis à jour en `SIGNED_ELECTRONICALLY`. Supprime le lien de signature pour éviter une réutilisation.",
      "operationId": "signContractViaLink",
      "tags": ["Contracts"],
      "parameters": [
        {
          "name": "token",
          "in": "path",
          "required": true,
          "description": "Token unique du lien de signature électronique",
          "schema": {
            "type": "string",
            "example": "ec761633-8a87-4d58-8373-afacc03a602a"
          }
        }
      ],
      "responses": {
        "200": {
          "description": "Contrat signé électroniquement avec succès",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean", "example": true },
                  "data": {
                    "type": "object",
                    "properties": {
                      "id": { "type": "string", "format": "uuid", "example": "79b4ebae-f107-4ca4-953e-b53b2e66e57a" },
                      "contract_number": { "type": "string", "example": "CT-2025-0012" },
                      "status": { "type": "string", "example": "SIGNED_ELECTRONICALLY" },
                      "start_datetime": { "type": "string", "format": "date-time", "example": "2025-11-05T11:00:00.000Z" },
                      "end_datetime": { "type": "string", "format": "date-time", "example": "2025-11-06T11:00:00.000Z" },
                      "total_price_ht": { "type": "number", "example": 2083.33 },
                      "total_price_ttc": { "type": "number", "example": 2500.0 },
                      "deposit_payment_method": { "type": "string", "example": "card" },
                      "updated_at": { "type": "string", "format": "date-time", "example": "2025-11-03T10:30:00.000Z" },
                      "customer": {
                        "type": "object",
                        "properties": {
                          "id": { "type": "string", "format": "uuid", "example": "4d8fdff7-10b5-4ee4-b5a4-68ff0ceec443" },
                          "firstname": { "type": "string", "example": "Lina" },
                          "lastname": { "type": "string", "example": "Dupont" },
                          "email": { "type": "string", "example": "lina.dupont@email.com" },
                          "phone": { "type": "string", "example": "+33612345678" },
                          "city": { "type": "string", "example": "Paris" }
                        }
                      },
                      "contract_type": {
                        "type": "object",
                        "properties": {
                          "id": { "type": "string", "format": "uuid", "example": "9eacb1d1-5c9e-4f12-a828-8aafc4ec95f3" },
                          "name": { "type": "string", "example": "Location journalière" }
                        }
                      }
                    }
                  }
                }
              },
              "example": {
                "success": true,
                "data": {
                  "id": "79b4ebae-f107-4ca4-953e-b53b2e66e57a",
                  "contract_number": "CT-2025-0012",
                  "status": "SIGNED_ELECTRONICALLY",
                  "start_datetime": "2025-11-05T11:00:00.000Z",
                  "end_datetime": "2025-11-06T11:00:00.000Z",
                  "total_price_ht": 2083.33,
                  "total_price_ttc": 2500,
                  "deposit_payment_method": "card",
                  "updated_at": "2025-11-03T10:30:00.000Z",
                  "customer": {
                    "id": "4d8fdff7-10b5-4ee4-b5a4-68ff0ceec443",
                    "firstname": "Lina",
                    "lastname": "Dupont",
                    "email": "lina.dupont@email.com",
                    "phone": "+33612345678",
                    "city": "Paris"
                  },
                  "contract_type": {
                    "id": "9eacb1d1-5c9e-4f12-a828-8aafc4ec95f3",
                    "name": "Location journalière"
                  }
                }
              }
            }
          }
        },
        "404": {
          "description": "Lien invalide ou contrat introuvable",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean", "example": false },
                  "error": { "type": "string", "example": "Lien invalide" }
                }
              }
            }
          }
        },
        "410": {
          "description": "Le lien de signature a expiré",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean", "example": false },
                  "error": { "type": "string", "example": "Lien expiré" }
                }
              }
            }
          }
        },
        "500": {
          "description": "Erreur interne du serveur",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean", "example": false },
                  "error": { "type": "string", "example": "Erreur interne lors de la signature" }
                }
              }
            }
          }
        }
      }
    }
  }
}
